# Marpでプレゼンテーションを作成するノウハウ集

## 1. Marpの基本

- **概要**: Marp (Markdown Presentation Ecosystem)はMarkdownを使って美しいスライドデッキを直感的に作成できるツールです。
- **基本的な使い方**: 標準的なMarkdown記法を使ってプレゼンテーションを作成し、「---」を使ってスライドを区切ります。
- **プラットフォーム**: VS Code拡張機能、CLIツール、その他のツールが提供されています。
- **出力形式**: HTML、PDF、PowerPointファイルに直接変換できます。
- **シンプルさ**: Markdownを使った文書作成は簡単で、オプションが多すぎず、シンプルなプレゼンテーションに適しています。
- **コンテンツ重視**: 複雑なフォーマットやデザインに悩まされずに、メッセージやコンテンツに集中できます。
- **カスタマイズ性**: CSSを使って独自のスタイルやレイアウトを作成できます。
- **コード表示**: プログラミングコードのインデントや表示が容易で、技術的なプレゼンテーションに適しています。
  
### サンプル: 基本的なMarpファイル

```markdown
---
marp: true
theme: default
paginate: true
---

# Marpプレゼンテーションの例

作成者: あなたの名前

---

## Marpとは？

- Markdown形式でプレゼンテーションを作成できるツール
- シンプルで使いやすい
- 複数のエクスポート形式をサポート

---

## 主な特徴

1. Markdownベース
2. VS Code統合
3. HTMLやPDFへのエクスポート
4. テーマのカスタマイズ
```

## 2. スライド作成テクニック

### 2.1 基本構造

- **スライド区切り**: 「---」を使って新しいスライドを作成します。
- **フロントマター**: プレゼンテーション全体の設定を行うための重要な部分です。
- **テーマ設定**: デフォルトでは「default」「gaia」「uncover」の3つの組み込みテーマが利用可能です。

テーマは、以下のような違いがあります。

| **特徴**   | **Defaultテーマ**  | **Gaiaテーマ**   | **Uncoverテーマ**    |
|-------|---------|------------|----------------|
| **背景色** | 白色    | クリーム色   | 黒色   |
| **文字色**   | 黒色     | 緑がかったグレー      | 白色    |
| **レイアウト**   | 中央寄せ       | 左寄せ   | 中央寄せ   |
| **フォントサイズ**| 通常   | 大きめ   | 大きめ   |
| **使用シーン**   | 一般的なプレゼンテーション  | 一般的なプレゼンテーション  | キャッチコピーや重要なポイントを強調 |
| **カスタマイズ** | スライド全体に適用される      | スライド全体に適用される                       | スライドごとに異なるデザインを適用可能       |


### 2.2 画像の扱い方

- **基本的な画像挿入**: 「```![](画像パス)```」の形式で画像を挿入できますが、サイズ調整には特別なディレクティブが必要です。
- **サイズ指定**: 「```![w:500](画像.png)```」のように幅や高さを指定できます。
- **背景画像**: 「bg」フラグを使って背景画像として設定でき、スライドとの相互作用が変わります。
- **位置指定**: 「left」や「right」のキーワードを使って背景の表示位置を制御したり、パーセンテージで領域を指定したりできます。
- **フィルター適用**: 画像にはgrayscale、sepia、blur、opacityなどのフィルターを適用できます。
- **カスタム配置**: CSSを活用して画像の位置を細かく制御できます。

### サンプル: 画像サイズと配置

```markdown
---
marp: true
---

# 画像のサイズ指定

![w:300](./images/logo.png)
![h:200](./images/photo.jpg)
![w:300 h:150](./images/banner.png)

---

# 背景画像

![bg](./images/background.jpg)

## 背景画像のあるスライド

---

# 背景画像の位置指定

![bg right](./images/right-image.jpg)

## 右側に背景画像

テキストは左側に配置されます

---

# 背景画像の領域指定

![bg right:30%](./images/small-right.jpg)

## 右側30%に背景画像

テキストは左側の70%に配置されます

---

# 画像フィルター

![bg blur](./images/blurred.jpg)

## ぼかしフィルターを適用した背景

---

# 複数フィルターの組み合わせ

![bg opacity:.3 grayscale](./images/faded.jpg)

## 透明度とグレースケールを適用
```

### 2.3 レイアウトとスタイリング

- **スタイルのカスタマイズ**: スタイルシートを追加してプレゼンテーションをカスタマイズできますが、基本的なCSS知識が必要です。
- **色と背景**: CSS変数を編集してテキストや背景色を変更できます。
- **フォント設定**: 見出しや本文のフォントを変更するCSSを追加できます。
- **グリッドレイアウト**: CSSグリッドを使って2カラムレイアウトなどを実現できます。

### サンプル: スタイルのカスタマイズ

```markdown
---
marp: true
style: |
  :root {
    --color-background: #1e1e1e;
    --color-foreground: #ddd;
    --color-highlight: #f96;
  }
  h1 {
    color: var(--color-highlight);
    font-family: 'Arial', sans-serif;
  }
  p {
    font-size: 24px;
  }
  .columns {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
  }
---

# カスタムスタイルの例

テキストは明るい色で、背景は暗めです

---

# 2カラムレイアウト

<div class="columns">
<div>

## 左側カラム
- 項目1
- 項目2
- 項目3

</div>
<div>

## 右側カラム
1. 番号付き1
2. 番号付き2
3. 番号付き3

</div>
</div>
```

### 2.4 ディレクティブの活用

- **グローバルディレクティブ**: スライド全体に適用される設定（テーマ、サイズなど）を制御します。
- **ローカルディレクティブ**: 特定のスライドに対する設定（ページ番号、ヘッダー、フッターなど）を制御します。
- **スコープ付きディレクティブ**: 名前に「_」接頭辞を付けると、現在のページにのみ適用され、後続のページには継承されません。

### サンプル: ディレクティブの使用

```markdown
---
marp: true
theme: default
paginate: true
header: "ヘッダーテキスト"
footer: "フッターテキスト"
size: 16:9
---

# すべてのスライドに適用されるグローバル設定

ヘッダーとフッターが表示されています

---
<!-- _header: "このスライドのみのヘッダー" -->
<!-- _footer: "このスライドのみのフッター" -->
<!-- _paginate: false -->

# スコープ付きディレクティブのサンプル

このスライドには独自のヘッダーとフッターがあり、ページ番号は非表示です

---

# 元のヘッダーとフッターに戻る

前のスライドの変更は引き継がれません
```

### 2.5 上級テクニック

- **スピーカーノート**: HTML形式のコメント「<!-- -->」を使ってスピーカーノートを追加できます。
- **見出し分割**: 「headingDivider」ディレクティブを使うと、既存のMarkdownドキュメントを見出しごとに自動的にスライドに分割できます。
- **リンクによるジャンプ**: マークダウンリンクを使ってスライド番号にジャンプするリンクを作成できます。
- **HTMLの使用**: セキュリティ上の理由からデフォルトではHTMLは使用できませんが、ローカルで表示する場合は設定できます。

### サンプル: スピーカーノートと見出し分割

```markdown
---
marp: true
headingDivider: 2  # h2見出しでスライドを分割
---

# メインタイトル

<!--
ここにスピーカーノートを入れられます。
発表時の補足説明やリマインダーとして役立ちます。
-->

## 最初のセクション

このテキストは新しいスライドになります（headingDividerにより）

<!--
このスライドでは以下のポイントを強調する：
- ポイント1の詳細
- 質問があれば受け付ける
-->

## 二番目のセクション

ここも自動的に新しいスライドになります

---

# ナビゲーションリンク

- [最初のセクションへ](#3)
- [二番目のセクションへ](#4)
- [最後のスライドへ](#6)

## サブセクション

追加の内容
```

## 3. 実践的なテンプレート

### 3.1 会社のプレゼンテーションテンプレート

```markdown
---
marp: true
theme: default
style: |
  :root {
    --color-background: white;
    --color-foreground: #333;
    --color-highlight: #0077cc;
    --color-dimmed: #888;
  }
  h1 {
    color: var(--color-highlight);
    border-bottom: 2px solid var(--color-highlight);
    padding-bottom: 8px;
  }
  footer {
    font-size: 10px;
    color: var(--color-dimmed);
  }
paginate: true
footer: "© 2025 会社名 - 社外秘"
---

<!-- _class: lead -->

# プロジェクト提案書

2025年4月20日
営業部 鈴木太郎

---

# アジェンダ

1. 提案背景
2. 課題分析
3. 解決策の提案
4. 導入スケジュール
5. 予算と効果

---

# 提案背景

...
```

### 3.2 学術発表用テンプレート

```markdown
---
marp: true
theme: gaia
style: |
  :root {
    --color-background: #f5f5f5;
    --color-foreground: #333;
  }
  h1 {
    font-size: 1.8em;
  }
  .cite {
    font-size: 0.7em;
    color: #666;
  }
paginate: true
---

<!-- _class: lead -->

# 研究タイトル
## サブタイトル

山田花子
○○大学 △△研究室

---

# 研究概要

- 背景
- 目的
- 方法
- 結果
- 考察

---

# 実験方法

![bg right:40% w:400](./img/experiment-setup.jpg)

- 被験者: 20名 (20-35歳)
- 期間: 2024年1月〜3月
- 手法: ...

<p class="cite">画像: 実験セットアップ (2024)</p>

---

# 実験結果

```
